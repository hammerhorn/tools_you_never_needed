#!/usr/bin/python3
"""
this will handle running commands in a new terminal window
maybe other options down the road
"""
import os
import subprocess


import termcolor
import misc

SCRIPT = r"""#!/usr/bin/env bash
#mytitle="Message Viewer"
#echo -e '\033k'$mytitle'\033\\'
#echo -e "\e]2;Message Viewer\a"

{}
echo -e "\n\x1b[?25l"
echo -e "\x1b[38;5;208m{}\x1b[38;5;208m:\nPress [ENTER] to close window.\x1b[0m"
read -s -n 1 x
"""

def runbashcommand(bashcommand):
    """
    This function runs a command in the default terminal
    emulator in a new window
    """
    script_text = SCRIPT.format(
        bashcommand, termcolor.colored(misc.MODULE_NAME, attrs=['underline']))
    try:
        with open('temp.sh', 'w') as temp_script:
            temp_script.write(script_text)

        # running 'bash temp.sh' doesn't work with some terminals
        # so actually make it executable, and also disable D-Bus in terminator
        # settings
        command = f'chmod +x temp.sh && x-terminal-emulator -T '\
                  f'{misc.MODULE_NAME} -e ./temp.sh'
        proc = subprocess.Popen(command, shell=True)
        proc.wait()
    finally:
        os.remove('temp.sh')
